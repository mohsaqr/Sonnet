<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>cograph Architecture &amp; Philosophy</title>
  <style>
    :root {
      --bg-primary: #0d1117;
      --bg-secondary: #161b22;
      --bg-tertiary: #21262d;
      --text-primary: #e6edf3;
      --text-secondary: #8b949e;
      --text-muted: #6e7681;
      --accent-blue: #58a6ff;
      --accent-green: #3fb950;
      --accent-purple: #a371f7;
      --accent-orange: #d29922;
      --accent-red: #f85149;
      --border-color: #30363d;
      --code-bg: #1f2428;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      font-size: 16px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    /* Header */
    header {
      text-align: center;
      padding: 3rem 0;
      border-bottom: 1px solid var(--border-color);
      margin-bottom: 2rem;
    }

    header h1 {
      font-size: 2.5rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    header .tagline {
      color: var(--text-secondary);
      font-size: 1.25rem;
    }

    /* Navigation */
    nav {
      background: var(--bg-secondary);
      border-radius: 8px;
      padding: 1.5rem;
      margin-bottom: 2rem;
      border: 1px solid var(--border-color);
    }

    nav h2 {
      font-size: 1rem;
      color: var(--text-secondary);
      margin-bottom: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    nav ul {
      list-style: none;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 0.5rem;
    }

    nav a {
      color: var(--accent-blue);
      text-decoration: none;
      padding: 0.25rem 0;
      display: block;
      transition: color 0.2s;
    }

    nav a:hover {
      color: var(--accent-purple);
    }

    /* Sections */
    section {
      margin-bottom: 3rem;
    }

    h2 {
      font-size: 1.75rem;
      font-weight: 600;
      margin-bottom: 1.5rem;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid var(--accent-blue);
      color: var(--text-primary);
    }

    h3 {
      font-size: 1.25rem;
      font-weight: 600;
      margin: 1.5rem 0 1rem;
      color: var(--accent-purple);
    }

    h4 {
      font-size: 1.1rem;
      font-weight: 600;
      margin: 1.25rem 0 0.75rem;
      color: var(--accent-green);
    }

    p {
      margin-bottom: 1rem;
      color: var(--text-primary);
    }

    /* Code blocks */
    pre {
      background: var(--code-bg);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      padding: 1rem;
      overflow-x: auto;
      margin: 1rem 0;
      font-size: 0.875rem;
    }

    code {
      font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
      font-size: 0.875em;
    }

    :not(pre) > code {
      background: var(--bg-tertiary);
      padding: 0.2em 0.4em;
      border-radius: 4px;
      color: var(--accent-orange);
    }

    /* Diagrams */
    .diagram {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 1.5rem;
      margin: 1.5rem 0;
      overflow-x: auto;
    }

    .diagram pre {
      background: transparent;
      border: none;
      padding: 0;
      margin: 0;
      color: var(--text-primary);
    }

    /* Tables */
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
      font-size: 0.9rem;
    }

    th, td {
      padding: 0.75rem 1rem;
      text-align: left;
      border: 1px solid var(--border-color);
    }

    th {
      background: var(--bg-tertiary);
      font-weight: 600;
      color: var(--accent-blue);
    }

    tr:nth-child(even) {
      background: var(--bg-secondary);
    }

    /* Cards */
    .card {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 1.5rem;
      margin: 1rem 0;
    }

    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1rem;
      margin: 1rem 0;
    }

    .card h4 {
      margin-top: 0;
      color: var(--accent-blue);
    }

    /* Structure box */
    .structure-box {
      background: linear-gradient(135deg, rgba(88, 166, 255, 0.1), rgba(163, 113, 247, 0.1));
      border: 1px solid var(--accent-blue);
      border-radius: 8px;
      padding: 1.5rem;
      margin: 1.5rem 0;
    }

    .structure-box h4 {
      color: var(--accent-blue);
      margin-top: 0;
    }

    /* Lists */
    ul, ol {
      margin: 1rem 0;
      padding-left: 1.5rem;
    }

    li {
      margin: 0.5rem 0;
    }

    /* File tree */
    .file-tree {
      font-family: 'SFMono-Regular', Consolas, monospace;
      font-size: 0.85rem;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 1.5rem;
      margin: 1rem 0;
    }

    .file-tree .folder {
      color: var(--accent-blue);
    }

    .file-tree .file {
      color: var(--text-secondary);
    }

    .file-tree .comment {
      color: var(--text-muted);
    }

    /* Badges */
    .badge {
      display: inline-block;
      padding: 0.25em 0.6em;
      font-size: 0.75rem;
      font-weight: 600;
      border-radius: 4px;
      margin-right: 0.5rem;
    }

    .badge-blue { background: rgba(88, 166, 255, 0.2); color: var(--accent-blue); }
    .badge-green { background: rgba(63, 185, 80, 0.2); color: var(--accent-green); }
    .badge-purple { background: rgba(163, 113, 247, 0.2); color: var(--accent-purple); }
    .badge-orange { background: rgba(210, 153, 34, 0.2); color: var(--accent-orange); }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--bg-secondary);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--text-muted);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .container {
        padding: 1rem;
      }

      header h1 {
        font-size: 1.75rem;
      }

      nav ul {
        grid-template-columns: 1fr;
      }

      .card-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>cograph Architecture &amp; Philosophy</h1>
      <p class="tagline">Modern Network Visualization for R</p>
    </header>

    <nav>
      <h2>Table of Contents</h2>
      <ul>
        <li><a href="#design-philosophy">Design Philosophy</a></li>
        <li><a href="#architecture-overview">Architecture Overview</a></li>
        <li><a href="#cograph-network-structure">cograph_network Structure</a></li>
        <li><a href="#class-system">Class System</a></li>
        <li><a href="#input-pipeline">Input Pipeline</a></li>
        <li><a href="#layout-system">Layout System</a></li>
        <li><a href="#rendering-pipeline">Rendering Pipeline</a></li>
        <li><a href="#theming-aesthetics">Theming &amp; Aesthetics</a></li>
        <li><a href="#specialized-features">Specialized Features</a></li>
        <li><a href="#file-organization">File Organization</a></li>
      </ul>
    </nav>

    <!-- Design Philosophy -->
    <section id="design-philosophy">
      <h2>Design Philosophy</h2>

      <h3>Core Principles</h3>

      <div class="card-grid">
        <div class="card">
          <h4>1. Separation of Concerns</h4>
          <p>cograph follows a clear pipeline architecture:</p>
          <pre><code>Input -> Parse -> Layout -> Style -> Render</code></pre>
          <p>Each stage is independent and can be customized without affecting others.</p>
        </div>

        <div class="card">
          <h4>2. Pipe-Friendly Immutable Transformations</h4>
          <p>Every transformation function returns a new network object, enabling fluent chaining:</p>
          <pre><code>cograph(data) |>
  sn_layout("spring") |>
  sn_theme("dark") |>
  sn_nodes(fill = "steelblue") |>
  splot()</code></pre>
        </div>

        <div class="card">
          <h4>3. TNA-First Design</h4>
          <p>Built with Transition Network Analysis as a primary use case:</p>
          <ul>
            <li>Auto-detection of <code>tna</code> and <code>group_tna</code> objects</li>
            <li>Preservation of TNA metadata (weights, inits, labels, data)</li>
            <li>Specialized TNA visualization functions</li>
          </ul>
        </div>

        <div class="card">
          <h4>4. Extensibility via Registries</h4>
          <p>Global registries allow users to add custom:</p>
          <ul>
            <li>Layouts: <code>register_layout()</code></li>
            <li>Shapes: <code>register_shape()</code>, <code>register_svg_shape()</code></li>
            <li>Themes: <code>register_theme()</code></li>
            <li>Palettes: Custom palette functions</li>
          </ul>
        </div>

        <div class="card">
          <h4>5. Reproducibility</h4>
          <ul>
            <li>Deterministic layouts via <code>seed</code> parameter</li>
            <li>All parameters stored in network object</li>
            <li>Consistent output across runs</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Architecture Overview -->
    <section id="architecture-overview">
      <h2>Architecture Overview</h2>

      <div class="diagram">
        <pre>
+-------------------------------------------------------------+
|                        USER API                              |
|  as_cograph() | cograph() | splot() | soplot() | sn_*()    |
+-------------------------------------------------------------+
                              |
                              v
+-------------------------------------------------------------+
|                    S3 WRAPPER LAYER                          |
|                   cograph_network                            |
|  (User-facing interface with $ access to all components)     |
+-------------------------------------------------------------+
                              |
                              v
+-------------------------------------------------------------+
|                     R6 CORE LAYER                            |
|  CographNetwork | CographLayout | CographTheme               |
|  (Internal mutable state and methods)                        |
+-------------------------------------------------------------+
                              |
          +-------------------+-------------------+
          v                   v                   v
+-----------------+ +-----------------+ +-----------------+
|  INPUT PARSERS  | | LAYOUT ENGINES  | |    RENDERERS    |
|  parse_matrix() | | layout_spring() | | splot() - base  |
|  parse_tna()    | | layout_circle() | | soplot() - grid |
|  parse_igraph() | | layout_groups() | | sn_ggplot()     |
|  ...            | | ...             | |                 |
+-----------------+ +-----------------+ +-----------------+
        </pre>
      </div>
    </section>

    <!-- cograph_network Structure -->
    <section id="cograph-network-structure">
      <h2>cograph_network Structure</h2>

      <p>The <code>cograph_network</code> object is a named list with S3 class, providing clean <code>$</code> access to all components:</p>

      <div class="structure-box">
        <pre><code>net <- list(
  # ===============================================================
  # CORE EDGE DATA (vectors for backwards compatibility)
  # ===============================================================
  from   = integer(),     # Source node indices (1-based)
  to     = integer(),     # Target node indices (1-based)
  weight = numeric(),     # Edge weights
  edges  = data.frame(),  # Edge data frame (from, to, weight)

  # ===============================================================
  # CORE NODE DATA
  # ===============================================================
  nodes    = data.frame(id, label, name, x, y, ...),
  directed = logical(),   # TRUE/FALSE
  n_nodes  = integer(),   # Node count
  n_edges  = integer(),   # Edge count
  labels   = character(), # Node labels vector

  # ===============================================================
  # LAYOUT (computed by cograph(), NULL by as_cograph())
  # ===============================================================
  layout      = data.frame(x, y),  # or NULL
  layout_info = list(name, seed),  # or NULL

  # ===============================================================
  # AESTHETICS (set by sn_* functions)
  # ===============================================================
  node_aes = list(
    size = 0.05, shape = "circle", fill = "#4A90D9",
    border_color = "#2C5AA0", border_width = 1, alpha = 1,
    label_size = 10, label_color = "black", label_position = "center"
  ),
  edge_aes = list(
    width = 1, color = "gray50",
    positive_color = "#2E7D32", negative_color = "#C62828",
    alpha = 0.8, style = "solid", curvature = 0,
    arrow_size = 0.015, show_arrows = NULL
  ),
  theme       = NULL,     # CographTheme object
  plot_params = list(),   # Stored parameters

  # ===============================================================
  # METADATA
  # ===============================================================
  source = character(),   # "matrix", "tna", "igraph", "edgelist", etc.

  # ===============================================================
  # TNA INTEGRATION
  # ===============================================================
  tna = list(             # or NULL
    model       = &lt;tna object&gt;,
    type        = character(),
    group_index = integer(),
    group_name  = character()
  ),
  weights = matrix(),     # Full n x n weight matrix

  # ===============================================================
  # OPTIONAL GROUPINGS
  # ===============================================================
  layers      = NULL,     # Layer assignments
  clusters    = NULL,     # Cluster assignments
  groups      = NULL,     # Group assignments
  node_groups = NULL,     # data.frame(node, layer|cluster|group)

  # ===============================================================
  # VALIDATION (for bootstrap, permutation, etc.)
  # ===============================================================
  raw_data  = NULL,       # Raw data for resampling
  estimator = NULL        # Function to re-estimate network
)

class(net) <- c("cograph_network", "list")</code></pre>
      </div>

      <h3>Access Methods</h3>

      <div class="card-grid">
        <div class="card">
          <h4>Direct $ Access</h4>
          <pre><code>net$from       # edge sources
net$to         # edge targets
net$weight     # edge weights
net$nodes      # nodes data frame
net$directed   # TRUE/FALSE
net$n_nodes    # node count
net$labels     # node labels</code></pre>
        </div>

        <div class="card">
          <h4>Getter Functions</h4>
          <pre><code>get_nodes(net)   # nodes data frame
get_edges(net)   # edges data frame
get_labels(net)  # character vector
n_nodes(net)     # count
n_edges(net)     # count
is_directed(net) # TRUE/FALSE</code></pre>
        </div>

        <div class="card">
          <h4>Setter Functions</h4>
          <pre><code>set_nodes(net, nodes_df)
set_edges(net, edges_df)
set_layout(net, layout_df)
set_groups(net, groups)</code></pre>
        </div>
      </div>
    </section>

    <!-- Class System -->
    <section id="class-system">
      <h2>Class System</h2>

      <h3>Dual-Class Pattern</h3>
      <p>cograph uses a dual-class pattern combining R6 (internal) with S3 (user-facing):</p>

      <table>
        <tr>
          <th>Layer</th>
          <th>Purpose</th>
          <th>Benefits</th>
        </tr>
        <tr>
          <td><span class="badge badge-purple">R6</span></td>
          <td>Internal implementation</td>
          <td>Efficient mutable state, encapsulation, methods</td>
        </tr>
        <tr>
          <td><span class="badge badge-blue">S3</span></td>
          <td>User-facing interface</td>
          <td>Idiomatic R interface, method dispatch, $ access</td>
        </tr>
      </table>

      <h3>CographNetwork (R6)</h3>
      <p><span class="badge badge-orange">Location</span> <code>R/class-network.R</code></p>

      <pre><code>CographNetwork <- R6::R6Class(
  private = list(
    .nodes = NULL,      # Data frame: id, label, x, y, ...
    .edges = NULL,      # Data frame: from, to, weight, ...
    .directed = FALSE,  # Boolean
    .weights = NULL,    # Numeric vector
    .layout = NULL,     # Computed coordinates
    .node_aes = NULL,   # Node aesthetics
    .edge_aes = NULL,   # Edge aesthetics
    .theme = NULL,      # CographTheme object
    .layout_info = NULL,# Layout metadata
    .plot_params = NULL # Stored parameters
  ),
  public = list(
    initialize = function(input, directed, node_labels),
    clone_network = function(),
    # Getters/setters for all private fields
    get_nodes = function(), set_nodes = function(nodes),
    get_edges = function(), set_edges = function(edges),
    # ... etc
  ),
  active = list(
    n_nodes = function(),
    n_edges = function(),
    is_directed = function(),
    has_weights = function()
  )
)</code></pre>
    </section>

    <!-- Input Pipeline -->
    <section id="input-pipeline">
      <h2>Input Pipeline</h2>

      <h3>Universal Entry Point</h3>
      <p><code>as_cograph(x)</code> accepts any supported format and returns a <code>cograph_network</code>:</p>

      <pre><code># All these work:
as_cograph(matrix)           # Adjacency/weight matrix
as_cograph(data.frame)       # Edge list
as_cograph(igraph_obj)       # igraph
as_cograph(network_obj)      # statnet
as_cograph(qgraph_obj)       # qgraph
as_cograph(tna_obj)          # tna
as_cograph(group_tna_obj)    # group_tna</code></pre>

      <h3>Auto-Detection Flow</h3>
      <p><span class="badge badge-orange">Location</span> <code>R/input-parse.R</code></p>

      <div class="diagram">
        <pre>
parse_input(x)
    |
    +-- is.matrix(x)?        -> parse_matrix()
    +-- is.data.frame(x)?    -> parse_edgelist()
    +-- inherits(x, "igraph")? -> parse_igraph()
    +-- inherits(x, "network")? -> parse_statnet()
    +-- inherits(x, "qgraph")? -> parse_qgraph()
    +-- inherits(x, "tna")?  -> parse_tna()
    +-- inherits(x, "group_tna")? -> parse_group_tna()
        </pre>
      </div>

      <h3>Conversion Functions</h3>

      <table>
        <tr>
          <th>Function</th>
          <th>Output</th>
          <th>Description</th>
        </tr>
        <tr>
          <td><code>as_cograph()</code></td>
          <td>cograph_network</td>
          <td>Universal import from any format</td>
        </tr>
        <tr>
          <td><code>to_igraph()</code></td>
          <td>igraph</td>
          <td>Export to igraph object</td>
        </tr>
        <tr>
          <td><code>to_matrix()</code></td>
          <td>matrix</td>
          <td>Export to adjacency matrix</td>
        </tr>
        <tr>
          <td><code>to_df()</code></td>
          <td>data.frame</td>
          <td>Export to edge list</td>
        </tr>
        <tr>
          <td><code>to_network()</code></td>
          <td>network</td>
          <td>Export to statnet network</td>
        </tr>
      </table>

      <h3>Conversion Flow Diagram</h3>
      <div class="diagram">
        <pre>
                    +---------------+
                    |    matrix     |
                    +-------+-------+
                            |
    +---------------+       |       +---------------+
    |  data.frame   |-------+-------|    igraph     |
    +---------------+       |       +-------+-------+
                            v               |
                    +---------------+       |
    +---------------|  as_cograph() |-------+
    |               +-------+-------+
    |                       |
    |               +-------v-------+
    |               |cograph_network|
    |               +-------+-------+
    |                       |
    |         +-------------+-------------+--------------+
    |         v             v             v              v
    |  +------------+ +-----------+ +------------+ +----------+
    |  |to_igraph() | | to_df()   | |to_matrix() | | splot()  |
    |  +-----+------+ +-----+-----+ +-----+------+ +----------+
    |        |              |             |
    |        v              v             v
    |   +---------+  +-----------+ +---------+
    +-->| igraph  |  |data.frame | | matrix  |
        +---------+  +-----------+ +----+----+
                                        |
                                        v
                                  +------------+
                                  |to_network()|
                                  +------+-----+
                                         v
                                    +---------+
                                    | network |
                                    +---------+
        </pre>
      </div>
    </section>

    <!-- Layout System -->
    <section id="layout-system">
      <h2>Layout System</h2>

      <h3>Built-in Layouts</h3>
      <table>
        <tr>
          <th>Layout</th>
          <th>Description</th>
          <th>File</th>
        </tr>
        <tr>
          <td><code>"spring"</code> / <code>"fr"</code></td>
          <td>Fruchterman-Reingold force-directed</td>
          <td>layout-spring.R</td>
        </tr>
        <tr>
          <td><code>"circle"</code></td>
          <td>Nodes arranged in circle</td>
          <td>layout-circle.R</td>
        </tr>
        <tr>
          <td><code>"oval"</code> / <code>"ellipse"</code></td>
          <td>Nodes arranged in oval</td>
          <td>layout-oval.R</td>
        </tr>
        <tr>
          <td><code>"groups"</code></td>
          <td>Grouped circular layout</td>
          <td>layout-groups.R</td>
        </tr>
        <tr>
          <td><code>"grid"</code></td>
          <td>Regular grid</td>
          <td>layout-registry.R</td>
        </tr>
        <tr>
          <td><code>"random"</code></td>
          <td>Random positions</td>
          <td>layout-registry.R</td>
        </tr>
        <tr>
          <td><code>"star"</code></td>
          <td>Center node with ring</td>
          <td>layout-registry.R</td>
        </tr>
        <tr>
          <td><code>"bipartite"</code></td>
          <td>Two-column layout</td>
          <td>layout-registry.R</td>
        </tr>
      </table>

      <h3>igraph Integration</h3>
      <p>Two-letter codes for igraph layouts:</p>
      <ul>
        <li><code>"kk"</code> - Kamada-Kawai</li>
        <li><code>"fr"</code> - Fruchterman-Reingold</li>
        <li><code>"drl"</code> - DrL</li>
        <li><code>"mds"</code> - MDS</li>
        <li><code>"ni"</code> - Nicely</li>
        <li><code>"tr"</code> - Tree/Reingold-Tilford</li>
      </ul>

      <h3>Registry Pattern</h3>
      <pre><code># Register custom layout
register_layout("my_layout", function(network, ...) {
  n <- nrow(network$get_nodes())
  data.frame(x = runif(n), y = runif(n))
})

# Use it
splot(net, layout = "my_layout")</code></pre>
    </section>

    <!-- Rendering Pipeline -->
    <section id="rendering-pipeline">
      <h2>Rendering Pipeline</h2>

      <h3>Three Rendering Backends</h3>
      <table>
        <tr>
          <th>Function</th>
          <th>Backend</th>
          <th>Use Case</th>
        </tr>
        <tr>
          <td><code>splot()</code></td>
          <td>Base R graphics</td>
          <td>Fast, no dependencies, publication-ready</td>
        </tr>
        <tr>
          <td><code>soplot()</code></td>
          <td>Grid graphics</td>
          <td>Better compositing, legends</td>
        </tr>
        <tr>
          <td><code>sn_ggplot()</code></td>
          <td>ggplot2</td>
          <td>Editable, combine with other ggplots</td>
        </tr>
      </table>

      <h3>splot() Architecture</h3>
      <p><span class="badge badge-orange">Location</span> <code>R/splot.R</code> (main) + supporting files</p>

      <div class="diagram">
        <pre>
splot(x, ...)
    |
    +-- Process parameters (splot-params.R)
    +-- Setup plot device
    |
    +-- Render edges (splot-edges.R)
    |   +-- Calculate curves
    |   +-- Draw splines
    |   +-- Draw arrows (splot-arrows.R)
    |   +-- Draw edge labels (splot-labels.R)
    |
    +-- Render nodes (splot-nodes.R)
    |   +-- Basic shapes (circle, square, etc.)
    |   +-- Donuts (proportional fill rings)
    |   +-- Pies (segmented nodes)
    |   +-- Custom SVG shapes
    |
    +-- Render labels (splot-labels.R)
        </pre>
      </div>

      <h3>Node Features</h3>
      <div class="card-grid">
        <div class="card">
          <h4>Basic Shapes</h4>
          <p>circle, square, triangle, diamond, pentagon, hexagon, star, heart, ellipse, cross</p>
        </div>
        <div class="card">
          <h4>Donuts</h4>
          <pre><code>splot(net, donut_fill = c(0.3, 0.7, 0.5))</code></pre>
        </div>
        <div class="card">
          <h4>Pies</h4>
          <pre><code>splot(net, pie_values = list(
  c(0.4, 0.6),
  c(0.3, 0.3, 0.4)
))</code></pre>
        </div>
        <div class="card">
          <h4>Custom SVG</h4>
          <pre><code>splot(net, node_svg = "path/to/shape.svg")</code></pre>
        </div>
      </div>

      <h3>Edge Features</h3>
      <ul>
        <li><strong>Curvature:</strong> Bezier curves with tension control</li>
        <li><strong>Arrows:</strong> Configurable size, angle, position</li>
        <li><strong>Auto-curving:</strong> Reciprocal edges automatically curve apart</li>
        <li><strong>Self-loops:</strong> Configurable rotation</li>
        <li><strong>Weight scaling:</strong> Linear, log, sqrt, rank modes</li>
        <li><strong>Positive/negative coloring:</strong> Auto-color by weight sign</li>
        <li><strong>CI visualization:</strong> Uncertainty underlays</li>
        <li><strong>Edge labels:</strong> With shadows, backgrounds</li>
      </ul>
    </section>

    <!-- Theming & Aesthetics -->
    <section id="theming-aesthetics">
      <h2>Theming &amp; Aesthetics</h2>

      <h3>Theme System</h3>
      <p><span class="badge badge-orange">Location</span> <code>R/themes-builtin.R</code>, <code>R/themes-registry.R</code></p>

      <table>
        <tr>
          <th>Theme</th>
          <th>Description</th>
        </tr>
        <tr>
          <td><code>"classic"</code></td>
          <td>White background, blue nodes (default)</td>
        </tr>
        <tr>
          <td><code>"dark"</code></td>
          <td>Dark background, light elements</td>
        </tr>
        <tr>
          <td><code>"minimal"</code></td>
          <td>Subtle styling</td>
        </tr>
        <tr>
          <td><code>"colorblind"</code></td>
          <td>Optimized for color vision deficiency</td>
        </tr>
        <tr>
          <td><code>"grayscale"</code></td>
          <td>Black and white only</td>
        </tr>
      </table>

      <pre><code>splot(net, theme = "dark")</code></pre>

      <h3>Palette System</h3>
      <p><span class="badge badge-orange">Location</span> <code>R/palettes.R</code></p>
      <p>Built-in: viridis, colorblind, pastel, bright, grayscale</p>

      <pre><code>cograph(net) |>
  sn_palette("viridis", target = "nodes", by = "degree") |>
  splot()</code></pre>

      <h3>Piping Functions</h3>
      <table>
        <tr>
          <th>Function</th>
          <th>Purpose</th>
        </tr>
        <tr>
          <td><code>sn_layout()</code></td>
          <td>Change layout algorithm</td>
        </tr>
        <tr>
          <td><code>sn_theme()</code></td>
          <td>Apply visual theme</td>
        </tr>
        <tr>
          <td><code>sn_palette()</code></td>
          <td>Apply color palette</td>
        </tr>
        <tr>
          <td><code>sn_nodes()</code></td>
          <td>Customize node aesthetics</td>
        </tr>
        <tr>
          <td><code>sn_edges()</code></td>
          <td>Customize edge aesthetics</td>
        </tr>
      </table>
    </section>

    <!-- Specialized Features -->
    <section id="specialized-features">
      <h2>Specialized Features</h2>

      <h3>TNA Integration</h3>
      <pre><code>library(tna)
model <- tna(data)
net <- as_cograph(model)

# Check and retrieve
is_tna_network(net)      # TRUE
get_tna_model(net)       # Original tna object

# All TNA fields preserved
get_tna_model(net)$weights
get_tna_model(net)$inits
attr(get_tna_model(net)$data, "colors")</code></pre>

      <h3>Network Comparison</h3>
      <p><span class="badge badge-orange">Location</span> <code>R/plot-compare.R</code></p>
      <pre><code>plot_compare(net1, net2)  # Visualize differences
# Green = positive (net1 > net2)
# Red = negative (net1 < net2)</code></pre>

      <h3>Multi-Group Plots</h3>
      <table>
        <tr>
          <th>Function</th>
          <th>Purpose</th>
          <th>File</th>
        </tr>
        <tr>
          <td><code>plot_htna()</code></td>
          <td>Heterogeneous/bipartite networks</td>
          <td>plot-htna.R</td>
        </tr>
        <tr>
          <td><code>plot_mtna()</code></td>
          <td>Multi-cluster networks</td>
          <td>plot-htna-multi.R</td>
        </tr>
        <tr>
          <td><code>plot_mlna()</code></td>
          <td>Multilevel 3D perspective</td>
          <td>mlna.R</td>
        </tr>
        <tr>
          <td><code>plot_mcml()</code></td>
          <td>Multi-cluster multi-level</td>
          <td>plot-mcml.R</td>
        </tr>
      </table>

      <h3>Heatmaps</h3>
      <p><span class="badge badge-orange">Location</span> <code>R/plot-heatmap.R</code>, <code>R/plot-ml-heatmap.R</code></p>
      <pre><code>plot_heatmap(net)         # Basic heatmap
plot_ml_heatmap(ml_net)   # Multilayer heatmap</code></pre>
    </section>

    <!-- File Organization -->
    <section id="file-organization">
      <h2>File Organization</h2>

      <div class="file-tree">
        <pre>
<span class="folder">R/</span>
<span class="folder">+-- Core Architecture</span>
|   <span class="file">+-- class-network.R</span>      <span class="comment"># CographNetwork R6 + S3 wrapper</span>
|   <span class="file">+-- class-layout.R</span>       <span class="comment"># CographLayout R6</span>
|   <span class="file">+-- class-theme.R</span>        <span class="comment"># CographTheme R6</span>
|   <span class="file">+-- cograph.R</span>            <span class="comment"># Main API functions</span>
|   <span class="file">+-- aaa-globals.R</span>        <span class="comment"># Global registries</span>
|
<span class="folder">+-- Input Parsing</span>
|   <span class="file">+-- input-parse.R</span>        <span class="comment"># Dispatcher + helpers</span>
|   <span class="file">+-- input-matrix.R</span>       <span class="comment"># Matrix parser</span>
|   <span class="file">+-- input-edgelist.R</span>     <span class="comment"># Edge list parser</span>
|   <span class="file">+-- input-igraph.R</span>       <span class="comment"># igraph parser</span>
|   <span class="file">+-- input-statnet.R</span>      <span class="comment"># statnet parser</span>
|   <span class="file">+-- input-qgraph.R</span>       <span class="comment"># qgraph parser</span>
|   <span class="file">+-- input-tna.R</span>          <span class="comment"># TNA parser + helpers</span>
|
<span class="folder">+-- Layouts</span>
|   <span class="file">+-- layout-registry.R</span>    <span class="comment"># Registry + built-ins</span>
|   <span class="file">+-- layout-spring.R</span>      <span class="comment"># Force-directed</span>
|   <span class="file">+-- layout-circle.R</span>      <span class="comment"># Circular</span>
|   <span class="file">+-- layout-oval.R</span>        <span class="comment"># Oval/ellipse</span>
|   <span class="file">+-- layout-groups.R</span>      <span class="comment"># Grouped</span>
|
<span class="folder">+-- Rendering - Base R</span>
|   <span class="file">+-- splot.R</span>              <span class="comment"># Main function (2000+ lines)</span>
|   <span class="file">+-- splot-nodes.R</span>        <span class="comment"># Node rendering</span>
|   <span class="file">+-- splot-edges.R</span>        <span class="comment"># Edge rendering</span>
|   <span class="file">+-- splot-arrows.R</span>       <span class="comment"># Arrow heads</span>
|   <span class="file">+-- splot-labels.R</span>       <span class="comment"># Label placement</span>
|   <span class="file">+-- splot-geometry.R</span>     <span class="comment"># Geometric utilities</span>
|
<span class="folder">+-- Rendering - Grid/ggplot</span>
|   <span class="file">+-- render-grid.R</span>        <span class="comment"># Grid-based (soplot)</span>
|   <span class="file">+-- render-ggplot.R</span>      <span class="comment"># ggplot2 conversion</span>
|
<span class="folder">+-- Aesthetics</span>
|   <span class="file">+-- aes-nodes.R</span>          <span class="comment"># sn_nodes()</span>
|   <span class="file">+-- aes-edges.R</span>          <span class="comment"># sn_edges()</span>
|   <span class="file">+-- palettes.R</span>           <span class="comment"># Color palettes</span>
|   <span class="file">+-- themes-builtin.R</span>     <span class="comment"># Built-in themes</span>
|   <span class="file">+-- themes-registry.R</span>    <span class="comment"># Theme registry</span>
|
<span class="folder">+-- Shapes</span>
|   <span class="file">+-- shapes-basic.R</span>       <span class="comment"># Basic shapes</span>
|   <span class="file">+-- shapes-special.R</span>     <span class="comment"># Donuts, pies</span>
|   <span class="file">+-- shapes-svg.R</span>         <span class="comment"># SVG support</span>
|   <span class="file">+-- shapes-registry.R</span>    <span class="comment"># Shape registry</span>
|
<span class="folder">+-- Specialized Plots</span>
|   <span class="file">+-- plot-compare.R</span>       <span class="comment"># Network comparison</span>
|   <span class="file">+-- plot-heatmap.R</span>       <span class="comment"># Heatmaps</span>
|   <span class="file">+-- plot-htna.R</span>          <span class="comment"># Heterogeneous</span>
|   <span class="file">+-- plot-htna-multi.R</span>    <span class="comment"># Multi-cluster</span>
|   <span class="file">+-- mlna.R</span>               <span class="comment"># Multilevel</span>
|   <span class="file">+-- plot-mcml.R</span>          <span class="comment"># Multi-cluster multilevel</span>
|
<span class="folder">+-- Utilities</span>
    <span class="file">+-- network-utils.R</span>      <span class="comment"># Network helpers</span>
    <span class="file">+-- network-summary.R</span>    <span class="comment"># Summary statistics</span>
    <span class="file">+-- centrality.R</span>         <span class="comment"># Centrality measures</span>
    <span class="file">+-- output-save.R</span>        <span class="comment"># File saving</span>
    <span class="file">+-- utils-*.R</span>            <span class="comment"># Various utilities</span>
        </pre>
      </div>
    </section>

    <!-- Example Workflows -->
    <section id="example-workflows">
      <h2>Example Workflows</h2>

      <div class="card">
        <h4>Basic Workflow</h4>
        <pre><code>library(cograph)

# Create from matrix
mat <- matrix(runif(25), 5, 5)
rownames(mat) <- colnames(mat) <- LETTERS[1:5]

cograph(mat) |>
  sn_layout("spring", seed = 42) |>
  sn_theme("classic") |>
  splot(title = "My Network")</code></pre>
      </div>

      <div class="card">
        <h4>TNA Workflow</h4>
        <pre><code>library(cograph)
library(tna)

model <- tna(engagement_data)
net <- as_cograph(model)

# Use TNA features
splot(net,
  donut_fill = model$inits,  # Initial probabilities as donuts
  node_fill = attr(model$data, "colors"),  # TNA colors
  title = "Transition Network"
)

# Retrieve original for TNA analysis
original <- get_tna_model(net)
summary(original)</code></pre>
      </div>

      <div class="card">
        <h4>Advanced Styling</h4>
        <pre><code>cograph(mat) |>
  sn_layout("circle") |>
  splot(
    node_shape = "hexagon",
    node_size = 0.08,
    donut_fill = c(0.3, 0.7, 0.5, 0.9, 0.4),
    donut_color = "steelblue",
    edge_width = "weight",
    edge_color = "weight",
    curvature = 0.3,
    theme = "dark"
  )</code></pre>
      </div>
    </section>

    <footer style="text-align: center; padding: 2rem; border-top: 1px solid var(--border-color); margin-top: 2rem; color: var(--text-secondary);">
      <p>cograph - Modern Network Visualization for R</p>
    </footer>
  </div>
</body>
</html>
