<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>splot() Development Documentation • cograph</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="splot() Development Documentation"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">cograph</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/comparison-plots-demo.html">Network Comparison and Visualization</a></li>
    <li><a class="dropdown-item" href="articles/function-reference.html">Function Reference</a></li>
    <li><a class="dropdown-item" href="articles/heatmaps-demo.html">Network Heatmaps</a></li>
    <li><a class="dropdown-item" href="articles/input-formats.html">Input Formats</a></li>
    <li><a class="dropdown-item" href="articles/introduction.html">Introduction to cograph</a></li>
    <li><a class="dropdown-item" href="articles/mcml-examples.html">Nice Examples</a></li>
    <li><a class="dropdown-item" href="articles/network-structure-and-groups.html">Network Structure and Node Groups</a></li>
    <li><a class="dropdown-item" href="articles/ona-demo.html">ONA Demo: Window-to-Window Transitions</a></li>
    <li><a class="dropdown-item" href="articles/plotting-tna-models.html">Plotting TNA Models with splot</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mohsaqr/cograph/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>splot() Development Documentation</h1>
      <small class="dont-index">Source: <a href="https://github.com/mohsaqr/cograph/blob/HEAD/SPLOT_DEVELOPMENT.md" class="external-link"><code>SPLOT_DEVELOPMENT.md</code></a></small>
    </div>

<div id="splot-development-documentation" class="section level1">

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a></h2>
<p><code><a href="reference/splot.html">splot()</a></code> is a base R graphics network visualization function, designed as an alternative to <code><a href="reference/soplot.html">soplot()</a></code> which uses grid graphics. The goal is to replicate qgraph-style visualizations with better performance while maintaining API consistency with <code><a href="reference/soplot.html">soplot()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="philosophy">Philosophy<a class="anchor" aria-label="anchor" href="#philosophy"></a></h2>
<div class="section level3">
<h3 id="why-base-r-graphics">Why Base R Graphics?<a class="anchor" aria-label="anchor" href="#why-base-r-graphics"></a></h3>
<ol style="list-style-type: decimal"><li>
<strong>Performance</strong>: Base R graphics (<code><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon()</a></code>, <code><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines()</a></code>, <code><a href="https://rdrr.io/r/graphics/xspline.html" class="external-link">xspline()</a></code>, <code><a href="https://rdrr.io/r/graphics/symbols.html" class="external-link">symbols()</a></code>) are faster than grid grobs for large networks</li>
<li>
<strong>Consistency</strong>: Parameters use snake_case naming matching <code><a href="reference/soplot.html">soplot()</a></code> for unified API</li>
<li>
<strong>Simplicity</strong>: Direct coordinate system without NPC unit conversions</li>
<li>
<strong>xspline()</strong>: Produces smoother, more natural curves than grid’s bezier curves</li>
</ol></div>
<div class="section level3">
<h3 id="design-decisions">Design Decisions<a class="anchor" aria-label="anchor" href="#design-decisions"></a></h3>
<ol style="list-style-type: decimal"><li><p><strong>Curve Direction for Reciprocal Edges</strong>: When two nodes have edges in both directions (A→B and B→A), they curve in opposite directions forming an “ellipse” shape - one curves inward, one curves outward. This prevents overlap and matches qgraph behavior.</p></li>
<li><p><strong>Default Behavior</strong> (<code>curves=TRUE</code>): Only reciprocal edges are curved; single edges remain straight. This is the most common use case for network visualization.</p></li>
<li>
<p><strong>Curve Modes</strong>:</p>
<ul><li>
<code>curves=FALSE</code>: All edges straight</li>
<li>
<code>curves=TRUE</code> or <code>"mutual"</code>: Only reciprocal edges curved (default)</li>
<li>
<code>curves="force"</code>: All edges curved</li>
</ul></li>
<li>
<p><strong>Inward Curve Logic</strong>: For single edges with <code>curves="force"</code>, the curve should bend toward the network center. This is determined by:</p>
<ul><li>Calculate network center (mean of all node positions)</li>
<li>For each edge, use cross product to determine which side of the edge the center is on</li>
<li>Adjust curve sign to bend toward center</li>
</ul></li>
</ol></div>
</div>
<div class="section level2">
<h2 id="what-has-been-done">What Has Been Done<a class="anchor" aria-label="anchor" href="#what-has-been-done"></a></h2>
<div class="section level3">
<h3 id="files-created">Files Created<a class="anchor" aria-label="anchor" href="#files-created"></a></h3>
<table class="table"><thead><tr><th>File</th>
<th>Purpose</th>
</tr></thead><tbody><tr><td><code>R/splot.R</code></td>
<td>Main function with full parameter set</td>
</tr><tr><td><code>R/splot-edges.R</code></td>
<td>Edge rendering (straight, curved, self-loops)</td>
</tr><tr><td><code>R/splot-nodes.R</code></td>
<td>Node rendering with pie/donut support</td>
</tr><tr><td><code>R/splot-arrows.R</code></td>
<td>Arrow head drawing</td>
</tr><tr><td><code>R/splot-geometry.R</code></td>
<td>Coordinate transforms, <code><a href="reference/cent_to_edge.html">cent_to_edge()</a></code>
</td>
</tr><tr><td><code>R/splot-params.R</code></td>
<td>Parameter vectorization helpers</td>
</tr><tr><td><code>R/splot-polygons.R</code></td>
<td>Shape vertex definitions</td>
</tr><tr><td><code>R/splot-labels.R</code></td>
<td>Edge label template formatting helpers</td>
</tr><tr><td><code>inst/examples/splot_tests.Rmd</code></td>
<td>Test networks (7-15 nodes)</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="features-implemented">Features Implemented<a class="anchor" aria-label="anchor" href="#features-implemented"></a></h3>
<ul><li>All node shapes (circle, square, triangle, diamond, pentagon, hexagon, star, heart, ellipse, cross)</li>
<li>Pie chart nodes</li>
<li>Donut chart nodes</li>
<li>Curved edges with xspline()</li>
<li>Self-loops (circular arc style)</li>
<li>Edge labels (basic and template-based)</li>
<li>Edge CI underlays (uncertainty visualization)</li>
<li>Enhanced edge labels with templates ({est}, {range}, {p}, {stars})</li>
<li>Node labels</li>
<li>Weighted edge widths and colors (positive/negative)</li>
<li>Arrow heads</li>
<li>Bidirectional arrows</li>
<li>Multiple layout algorithms (circle, spring, groups)</li>
<li>File output (PNG, PDF, SVG, JPEG, TIFF)</li>
</ul></div>
<div class="section level3">
<h3 id="curve-logic">Curve Logic<a class="anchor" aria-label="anchor" href="#curve-logic"></a></h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># In splot.R - determine curve signs for reciprocal edges</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">is_reciprocal</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Opposite directions: lower index gets positive curve</span></span>
<span>  <span class="va">curves_vec</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="va">edges</span><span class="op">$</span><span class="va">from</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">edges</span><span class="op">$</span><span class="va">to</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="fl">0.2</span> <span class="kw">else</span> <span class="op">-</span><span class="fl">0.2</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># In splot-edges.R - render_edges_base()</span></span>
<span><span class="co"># Positive curve = bend toward center (inward)</span></span>
<span><span class="co"># Negative curve = bend away from center (outward)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">curve_i</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Calculate cross product to determine which side center is on</span></span>
<span>  <span class="va">cross</span> <span class="op">&lt;-</span> <span class="va">dx</span> <span class="op">*</span> <span class="va">to_center_y</span> <span class="op">-</span> <span class="va">dy</span> <span class="op">*</span> <span class="va">to_center_x</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">cross</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">curve_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">curve_i</span><span class="op">)</span>   <span class="co"># Bend left toward center</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">curve_i</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">curve_i</span><span class="op">)</span>  <span class="co"># Bend right toward center</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="what-needs-to-be-done">What Needs To Be Done<a class="anchor" aria-label="anchor" href="#what-needs-to-be-done"></a></h2>
<div class="section level3">
<h3 id="id_1-high-priority-inward-curve-direction-fix-done">1. <del>HIGH PRIORITY: Inward Curve Direction Fix</del> DONE<a class="anchor" aria-label="anchor" href="#id_1-high-priority-inward-curve-direction-fix-done"></a></h3>
<p><strong>Problem</strong>: When <code>curves="force"</code> is used, single (non-reciprocal) edges should curve inward toward the network center. Previously, the direction was inconsistent.</p>
<p><strong>Solution</strong>: The issue was that <code><a href="reference/render_edges_splot.html">render_edges_splot()</a></code> in <code>splot.R</code> was not applying the inward curve logic that existed in <code><a href="reference/render_edges_base.html">render_edges_base()</a></code>. Fixed by adding the same logic to <code><a href="reference/render_edges_splot.html">render_edges_splot()</a></code>: 1. Calculate network center as mean of all node positions 2. For each edge with positive curve value, use cross product to determine which side of the edge the center is on 3. Adjust curve sign: positive (bend left) if center is to the left, negative (bend right) if center is to the right 4. Negative curves (reciprocal edges curving outward) keep their original sign</p>
</div>
<div class="section level3">
<h3 id="id_2-high-priority-resolutiondpi-done">2. <del>HIGH PRIORITY: Resolution/DPI</del> DONE<a class="anchor" aria-label="anchor" href="#id_2-high-priority-resolutiondpi-done"></a></h3>
<p><strong>Problem</strong>: Output resolution needs to be higher for publication quality.</p>
<p><strong>Solution</strong>: Added <code>res</code> parameter to control DPI for raster outputs (PNG, JPEG, TIFF). Default is now 600 DPI for publication-quality output. The parameter is passed to <code><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">grDevices::png()</a></code>, <code><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">grDevices::jpeg()</a></code>, and <code><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">grDevices::tiff()</a></code> functions.</p>
</div>
<div class="section level3">
<h3 id="id_3-medium-priority-edge-label-positioning-done">3. <del>MEDIUM PRIORITY: Edge Label Positioning</del> DONE<a class="anchor" aria-label="anchor" href="#id_3-medium-priority-edge-label-positioning-done"></a></h3>
<p><strong>Problem</strong>: Edge labels on curved edges were positioned directly on the curve, causing overlap with the edge line.</p>
<p><strong>Solution</strong>: Added perpendicular offset to <code><a href="reference/get_edge_label_position.html">get_edge_label_position()</a></code> in <code>splot-edges.R</code>. Labels are now offset away from the edge line: - For curved edges: offset in the direction of the curve bulge (convex side) - For straight edges: offset perpendicular to the edge - Default offset of 0.03 user coordinates provides good separation</p>
</div>
<div class="section level3">
<h3 id="id_4-medium-priority-legend-support-done">4. <del>MEDIUM PRIORITY: Legend Support</del> DONE<a class="anchor" aria-label="anchor" href="#id_4-medium-priority-legend-support-done"></a></h3>
<p><strong>Problem</strong>: Legend only supported node groups, missing edge colors and node sizes.</p>
<p><strong>Solution</strong>: Enhanced <code><a href="reference/render_legend_splot.html">render_legend_splot()</a></code> to support three legend components: 1. <strong>Node groups</strong>: Filled squares showing group colors with labels 2. <strong>Edge colors</strong>: Lines showing positive/negative weight colors (controlled by <code>legend.edge.colors</code> parameter, default TRUE) 3. <strong>Node sizes</strong>: Circles showing small/medium/large scale (controlled by <code>legend.node.sizes</code> parameter, default FALSE)</p>
<p>New parameters added to <code><a href="reference/splot.html">splot()</a></code>: - <code>legend.edge.colors</code>: Show positive/negative edge color legend (default TRUE) - <code>legend.node.sizes</code>: Show node size scale legend (default FALSE)</p>
</div>
<div class="section level3">
<h3 id="id_5-high-priority-unified-api-with-soplot-done">5. <del>HIGH PRIORITY: Unified API with soplot()</del> DONE<a class="anchor" aria-label="anchor" href="#id_5-high-priority-unified-api-with-soplot-done"></a></h3>
<p><strong>Problem</strong>: <code><a href="reference/splot.html">splot()</a></code> used qgraph-style parameter names (e.g., <code>vsize</code>, <code>edge.color</code>, <code>posCol</code>) while <code><a href="reference/soplot.html">soplot()</a></code> used snake_case (e.g., <code>node_size</code>, <code>edge_color</code>, <code>positive_color</code>). This inconsistency made it harder for users to switch between the two functions.</p>
<p><strong>Solution</strong>: Updated <code><a href="reference/splot.html">splot()</a></code> to use the same snake_case parameter names as <code><a href="reference/soplot.html">soplot()</a></code>. The full mapping:</p>
<table class="table"><thead><tr><th>Old (qgraph-style)</th>
<th>New (snake_case)</th>
</tr></thead><tbody><tr><td><code>vsize</code></td>
<td><code>node_size</code></td>
</tr><tr><td><code>vsize2</code></td>
<td><code>node_size2</code></td>
</tr><tr><td><code>shape</code></td>
<td><code>node_shape</code></td>
</tr><tr><td><code>color</code></td>
<td><code>node_fill</code></td>
</tr><tr><td><code>border.color</code></td>
<td><code>node_border_color</code></td>
</tr><tr><td><code>border.width</code></td>
<td><code>node_border_width</code></td>
</tr><tr><td><code>alpha</code></td>
<td><code>node_alpha</code></td>
</tr><tr><td><code>label.cex</code></td>
<td><code>label_size</code></td>
</tr><tr><td><code>label.color</code></td>
<td><code>label_color</code></td>
</tr><tr><td><code>label.position</code></td>
<td><code>label_position</code></td>
</tr><tr><td><code>pie</code></td>
<td><code>pie_values</code></td>
</tr><tr><td><code>pieColor</code></td>
<td><code>pie_colors</code></td>
</tr><tr><td><code>donut</code></td>
<td><code>donut_values</code></td>
</tr><tr><td><code>donutColor</code></td>
<td><code>donut_colors</code></td>
</tr><tr><td><code>donut.inner</code></td>
<td><code>donut_inner_ratio</code></td>
</tr><tr><td><code>donut.bg</code></td>
<td><code>donut_bg_color</code></td>
</tr><tr><td><code>donut.show.value</code></td>
<td><code>donut_show_value</code></td>
</tr><tr><td><code>donut.value.cex</code></td>
<td><code>donut_value_size</code></td>
</tr><tr><td><code>donut.value.color</code></td>
<td><code>donut_value_color</code></td>
</tr><tr><td><code>edge.color</code></td>
<td><code>edge_color</code></td>
</tr><tr><td><code>edge.width</code></td>
<td><code>edge_width</code></td>
</tr><tr><td><code>edge.alpha</code></td>
<td><code>edge_alpha</code></td>
</tr><tr><td><code>edge.labels</code></td>
<td><code>edge_labels</code></td>
</tr><tr><td><code>edge.label.cex</code></td>
<td><code>edge_label_size</code></td>
</tr><tr><td><code>edge.label.color</code></td>
<td><code>edge_label_color</code></td>
</tr><tr><td><code>edge.label.bg</code></td>
<td><code>edge_label_bg</code></td>
</tr><tr><td><code>edge.label.position</code></td>
<td><code>edge_label_position</code></td>
</tr><tr><td><code>edge.label.font</code></td>
<td><code>edge_label_fontface</code></td>
</tr><tr><td><code>lty</code></td>
<td><code>edge_style</code></td>
</tr><tr><td><code>curve</code></td>
<td><code>curvature</code></td>
</tr><tr><td><code>curveScale</code></td>
<td><code>curve_scale</code></td>
</tr><tr><td><code>curveShape</code></td>
<td><code>curve_shape</code></td>
</tr><tr><td><code>curvePivot</code></td>
<td><code>curve_pivot</code></td>
</tr><tr><td><code>asize</code></td>
<td><code>arrow_size</code></td>
</tr><tr><td><code>arrows</code></td>
<td><code>show_arrows</code></td>
</tr><tr><td><code>loopRotation</code></td>
<td><code>loop_rotation</code></td>
</tr><tr><td><code>minimum</code></td>
<td><code>threshold</code></td>
</tr><tr><td><code>posCol</code></td>
<td><code>positive_color</code></td>
</tr><tr><td><code>negCol</code></td>
<td><code>negative_color</code></td>
</tr><tr><td><code>title.cex</code></td>
<td><code>title_size</code></td>
</tr><tr><td><code>mar</code></td>
<td><code>margins</code></td>
</tr><tr><td><code>legend.position</code></td>
<td><code>legend_position</code></td>
</tr><tr><td><code>legend.cex</code></td>
<td><code>legend_size</code></td>
</tr><tr><td><code>legend.edge.colors</code></td>
<td><code>legend_edge_colors</code></td>
</tr><tr><td><code>legend.node.sizes</code></td>
<td><code>legend_node_sizes</code></td>
</tr><tr><td><code>nodeNames</code></td>
<td><code>node_names</code></td>
</tr></tbody></table><p>Now both functions use identical parameter names for the same features.</p>
</div>
<div class="section level3">
<h3 id="id_6-high-priority-edge-ci-underlays-done">6. <del>HIGH PRIORITY: Edge CI Underlays</del> DONE<a class="anchor" aria-label="anchor" href="#id_6-high-priority-edge-ci-underlays-done"></a></h3>
<p><strong>Problem</strong>: Users need to visualize uncertainty in edge weights (e.g., confidence intervals from statistical models).</p>
<p><strong>Solution</strong>: Added CI underlay feature that draws each edge twice: 1. <strong>Underlay (first pass)</strong>: thicker, dashed, semi-transparent “halo” representing uncertainty 2. <strong>Main edge (second pass)</strong>: normal rendering on top</p>
<p>New parameters for <code><a href="reference/splot.html">splot()</a></code>: | Parameter | Type | Default | Description | |———–|——|———|————-| | <code>edge_ci</code> | numeric | NULL | CI width values (0-1 scale, bigger = more uncertainty) | | <code>edge_ci_scale</code> | numeric | 2.0 | Width multiplier for underlay thickness | | <code>edge_ci_alpha</code> | numeric | 0.15 | Transparency for underlay (0-1) | | <code>edge_ci_color</code> | character | NA | Underlay color (NA = use main edge color) | | <code>edge_ci_style</code> | numeric | 2 | Line type: 1=solid, 2=dashed, 3=dotted | | <code>edge_ci_arrows</code> | logical | FALSE | Show arrows on underlay? |</p>
<p>For <code><a href="reference/soplot.html">soplot()</a></code>, these are available via <code><a href="reference/sn_edges.html">sn_edges()</a></code> as: <code>ci</code>, <code>ci_scale</code>, <code>ci_alpha</code>, <code>ci_color</code>, <code>ci_style</code>, <code>ci_arrows</code>.</p>
<p>Example:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.8</span>, <span class="fl">0</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.7</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">3</span>, <span class="fl">3</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">ci_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/splot.html">splot</a></span><span class="op">(</span><span class="va">mat</span>,</span>
<span>  edge_ci <span class="op">=</span> <span class="va">ci_vals</span>,</span>
<span>  edge_ci_scale <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  edge_ci_alpha <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>  edge_ci_color <span class="op">=</span> <span class="st">"red3"</span>,</span>
<span>  edge_ci_style <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_7-high-priority-enhanced-edge-labels-done">7. <del>HIGH PRIORITY: Enhanced Edge Labels</del> DONE<a class="anchor" aria-label="anchor" href="#id_7-high-priority-enhanced-edge-labels-done"></a></h3>
<p><strong>Problem</strong>: Edge labels needed to display statistical information like estimates, confidence intervals, p-values, and significance stars in customizable formats.</p>
<p><strong>Solution</strong>: Added a template-based label system with preset styles and custom templates.</p>
<p><strong>Style Presets:</strong> | Style | Template | Example Output | |——-|———-|—————-| | <code>"none"</code> | (no labels) | | | <code>"estimate"</code> | <code>"{est}"</code> | <code>0.45</code> | | <code>"full"</code> | <code>"{est} {range}"</code> | <code>0.45 [0.32, 0.58]</code> | | <code>"range"</code> | <code>"{range}"</code> | <code>[0.32, 0.58]</code> | | <code>"stars"</code> | <code>"{stars}"</code> | <code>**</code> |</p>
<p><strong>Template Placeholders:</strong> | Placeholder | Source | Example | |————-|——–|———| | <code>{est}</code> | edge weight | <code>0.45</code> | | <code>{range}</code> | ci_lower + ci_upper | <code>[0.32, 0.58]</code> | | <code>{low}</code> | ci_lower | <code>0.32</code> | | <code>{up}</code> | ci_upper | <code>0.58</code> | | <code>{p}</code> | p-value | <code>p=0.012</code> | | <a href="https://r-spatial.github.io/stars/" class="external-link">stars</a> | significance stars | <code>**</code> |</p>
<p>New parameters for <code><a href="reference/splot.html">splot()</a></code>: | Parameter | Type | Default | Description | |———–|——|———|————-| | <code>edge_label_style</code> | character | “none” | Preset: “none”, “estimate”, “full”, “range”, “stars” | | <code>edge_label_template</code> | character | NULL | Custom template (overrides style) | | <code>edge_label_digits</code> | numeric | 2 | Decimal places for estimates | | <code>edge_label_oneline</code> | logical | TRUE | Single line format | | <code>edge_label_ci_format</code> | character | “bracket” | CI format: “bracket” or “dash” | | <code>edge_ci_lower</code> | numeric | NULL | Lower CI bounds | | <code>edge_ci_upper</code> | numeric | NULL | Upper CI bounds | | <code>edge_label_p</code> | numeric | NULL | P-values | | <code>edge_label_p_digits</code> | numeric | 3 | Decimal places for p-values | | <code>edge_label_p_prefix</code> | character | “p=” | Prefix for p-values | | <code>edge_label_stars</code> | * | NULL | Stars: character, logical, or numeric p-values |</p>
<p>Stars conversion from p-values: - p &lt; 0.001 → <code>***</code> - p &lt; 0.01 → <code>**</code> - p &lt; 0.05 → <code>*</code> - otherwise → (empty)</p>
<p>For <code><a href="reference/soplot.html">soplot()</a></code>, these are available via <code><a href="reference/sn_edges.html">sn_edges()</a></code> as: <code>label_style</code>, <code>label_template</code>, <code>label_digits</code>, <code>label_ci_format</code>, <code>ci_lower</code>, <code>ci_upper</code>, <code>label_p</code>, <code>label_p_digits</code>, <code>label_p_prefix</code>, <code>label_stars</code>.</p>
<p>Example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.8</span>, <span class="fl">0</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.7</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">3</span>, <span class="fl">3</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Template with estimate and stars</span></span>
<span><span class="fu"><a href="reference/splot.html">splot</a></span><span class="op">(</span><span class="va">mat</span>,</span>
<span>  edge_label_template <span class="op">=</span> <span class="st">"{est}{stars}"</span>,</span>
<span>  edge_label_p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.02</span>, <span class="fl">0.5</span>, <span class="fl">0.008</span>, <span class="fl">0.04</span>, <span class="fl">0.001</span><span class="op">)</span>,</span>
<span>  edge_label_digits <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Full labels with CI</span></span>
<span><span class="fu"><a href="reference/splot.html">splot</a></span><span class="op">(</span><span class="va">mat</span>,</span>
<span>  edge_label_template <span class="op">=</span> <span class="st">"{est} {range} {p}{stars}"</span>,</span>
<span>  edge_ci_lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  edge_ci_upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  edge_label_p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.02</span>, <span class="fl">0.5</span>, <span class="fl">0.008</span>, <span class="fl">0.04</span>, <span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_8-low-priority-performance-optimization">8. LOW PRIORITY: Performance Optimization<a class="anchor" aria-label="anchor" href="#id_8-low-priority-performance-optimization"></a></h3>
<p>For very large networks (&gt;500 nodes), consider: - Batch drawing of similar elements - Reducing xspline resolution for distant edges - Level-of-detail rendering</p>
</div>
</div>
<div class="section level2">
<h2 id="code-references">Code References<a class="anchor" aria-label="anchor" href="#code-references"></a></h2>
<ul><li>Main curve rendering: <code>R/splot-edges.R:draw_curved_edge_base()</code> (line ~86)</li>
<li>Inward direction logic: <code>R/splot-edges.R:render_edges_base()</code> (line ~380)</li>
<li>Reciprocal detection: <code>R/splot.R</code> (line ~340)</li>
<li>Perpendicular calculation: <code>R/splot-edges.R</code> (line ~105)</li>
</ul></div>
<div class="section level2">
<h2 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a></h2>
<p>Run the test RMarkdown:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">render</a></span><span class="op">(</span><span class="st">"inst/examples/splot_tests.Rmd"</span><span class="op">)</span></span></code></pre></div>
<p>Quick test:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.8</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/splot.html">splot</a></span><span class="op">(</span><span class="va">mat</span>, layout<span class="op">=</span><span class="st">"circle"</span>, curvature<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span></span></code></pre></div>
<p>Verify unified API (both should produce identical plots):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.8</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># splot (base R graphics)</span></span>
<span><span class="fu"><a href="reference/splot.html">splot</a></span><span class="op">(</span><span class="va">mat</span>, node_size<span class="op">=</span><span class="fl">0.1</span>, edge_color<span class="op">=</span><span class="st">"blue"</span>, curvature<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># soplot (grid graphics)</span></span>
<span><span class="fu"><a href="reference/soplot.html">soplot</a></span><span class="op">(</span><span class="fu"><a href="reference/cograph.html">cograph</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>, node_size<span class="op">=</span><span class="fl">0.1</span>, edge_color<span class="op">=</span><span class="st">"blue"</span>, curvature<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="related-files">Related Files<a class="anchor" aria-label="anchor" href="#related-files"></a></h2>
<ul><li>
<code>R/soplot.R</code> - Grid graphics version (for comparison)</li>
<li>
<code>R/render-edges.R</code> - Grid edge rendering (has aspect ratio fixes that may be useful)</li>
<li>
<code>R/utils-geometry.R</code> - Shared geometry utilities</li>
</ul></div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://saqr.me" class="external-link">Mohammed Saqr</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

